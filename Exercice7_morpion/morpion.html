<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Morpion</title>
</head>
<style>
    body{
        width: 100%;
    }
    .container{
        width: 80%;
        margin: 0 auto;
        display: flex;
        flex-wrap: wrap;
        text-align: center;
        justify-content: center;
    }
    .piece{
        width: 100%;
        margin-bottom: 25px;
    }
    .ligne{
        display: flex;
    }
    .case{
        width: 100px;
        height: 100px;
        border: 1px solid black;
        text-align: center;
        line-height: 100px;
        font-size: 34pt;
    }
    .coup{
        margin-top: 25px;
        width: 100%;
    }
</style>
<body>
    <div>
		<h1 style="margin-top: 0; width :100%;height: 150px; background-color:black; text-align: center; color:white; line-height: 150px;"><a style=" color:white; font-size: 15pt; position: absolute; top: 0; left:100px" href="https://duray.info/ExercicesJS/"> <<< Retour </a>Exercices JS </h1>
	</div>
    <div class="container">
        <h1>Jeu du morpion</h1>
        <div class="piece">Joueur qui joue : O</div>
        <div class="grille">
            <div class="ligne l1">
                <div class="case"></div>
                <div class="case"></div>
                <div class="case"></div>
            </div>
            <div class="ligne l2">
                <div class="case"></div>
                <div class="case"></div>
                <div class="case"></div>
            </div>
            <div class="ligne l3">
                <div class="case"></div>
                <div class="case"></div>
                <div class="case"></div>
            </div>   
        </div>
        <div class="coup">O commence ! Cliquez sur une case pour jouer !</div>
        <button id='rejouer' style="margin-top: 10px;">Rejouer</button>
        <button id='restart' style="margin-top: 10px; margin-left: 10px;">Recommencer</button>
    </div>
   

    <script>


        let pair = false
        let l1 = []
        let l2 = []
        let l3 = []

        let coupsX = 0
        let coupsO = 0

        let restart = document.querySelector('#restart')
        let reJouer = document.querySelector('#rejouer')
        let piece = document.querySelector('.piece')

        let ligne1 = document.querySelector('.l1')
        let casesl1 = ligne1.querySelectorAll('.case')
        let ligne2 = document.querySelector('.l2')
        let casesl2 = ligne2.querySelectorAll('.case')
        let ligne3 = document.querySelector('.l3')
        let casesl3 = ligne3.querySelectorAll('.case')
        
        let cases = document.querySelectorAll('.case')

        let coup = document.querySelector('.coup')

        //fonction qui vide les tableau représentant les lignes 
        function vider(){
            l1=[]
            l2=[]
            l3=[]
        }

        //insérer les X et O dans dans 3 tableaux pour les 3 lignes 
        function insert(){
            casesl1.forEach(element =>{
                let result = element.innerText
                l1.push(result)
                console.log('oke')
            })
            
            casesl2.forEach(element =>{
                let result = element.innerText
                l2.push(result)
                console.log('oke')
            })
            
            casesl3.forEach(element =>{
                let result = element.innerText
                l3.push(result)
                console.log('oke')
            })

        }

        


        cases.forEach(elem=>{
            

            elem.addEventListener('click',function(element){
                if(elem.innerText==""){
                    if(pair==true){
                        vider() //vider les tableau pour ne pas démultiplier les entrées
                        
                        pair= false
                        elem.innerText="X"
                        piece.innerText = "Joueur qui joue : O"
                        insert()
                    }else{
                        vider()  //vider les tableau pour ne pas démultiplier les entrées
                        
                        pair= true
                        elem.innerText="O"
                        piece.innerText = "Joueur qui joue : X"
                        insert()
                        
                    }
                    
                }
                console.log("ligne1 : "+l1)
                console.log("ligne2 : "+l2)
                console.log("ligne3 : "+l3)

                // attribution des points en fonction des lignes complétées pour O et pour X
                

                    if((l1[0]=="O" && l1[1]=="O" && l1[2]=="O")||(l1[0]=="X" && l1[1]=="X" && l1[2]=="X")){
                        if(l1[0]=="X"){
                            coupsX = coupsX +1
                            rejouer()
                        }else{
                            coupsO = coupsO +1
                            rejouer()
                        }
                    }else if((l2[0]=="O" && l2[1]=="O" && l2[2]=="O")||(l2[0]=="X" && l2[1]=="X" && l2[2]=="X")){
                        if(l2[0]=="X"){
                            coupsX = coupsX +1
                            rejouer()
                        }else{
                            coupsO = coupsO +1
                            rejouer()
                        }
                    }else if((l3[0]=="O" && l3[1]=="O" && l3[2]=="O")||(l3[0]=="X" && l3[1]=="X" && l3[2]=="X")){
                        if(l3[0]=="X"){
                            coupsX = coupsX +1
                            rejouer()
                        }else{
                            coupsO = coupsO +1
                            rejouer()
                        }
                    }else if((l1[0]=="O" && l2[0]=="O" && l3[0]=="O")||(l1[0]=="X" && l2[0]=="X" && l3[0]=="X")){
                        if(l1[0]=="X"){
                            coupsX = coupsX +1
                            rejouer()
                        }else{
                            coupsO = coupsO +1
                            rejouer()
                        }
                    }else if((l1[1]=="O" && l2[1]=="O" && l3[1]=="O")||(l1[1]=="X" && l2[1]=="X" && l3[1]=="X")){
                        if(l1[1]=="X"){
                            coupsX = coupsX +1
                            rejouer()
                        }else{
                            coupsO = coupsO +1
                            rejouer()
                        }
                    }else if((l1[2]=="O" && l2[2]=="O" && l3[2]=="O")||(l1[2]=="X" && l2[2]=="X" && l3[2]=="X")){
                        if(l1[2]=="X"){
                            coupsX = coupsX +1
                            rejouer()
                        }else{
                            coupsO = coupsO +1
                            rejouer()
                        }
                    }else if((l1[0]=="O" && l2[1]=="O" && l3[2]=="O")||(l1[0]=="X" && l2[1]=="X" && l3[2]=="X")){
                        if(l1[0]=="X"){
                            coupsX = coupsX +1
                            rejouer()
                        }else{
                            coupsO = coupsO +1
                            rejouer()
                        }
                    }else if((l1[2]=="O" && l2[1]=="O" && l3[0]=="O")||(l1[2]=="X" && l2[1]=="X" && l3[0]=="X")){
                        if(l1[2]=="X"){
                            coupsX = coupsX +1
                            rejouer()
                        }else{
                            coupsO = coupsO +1
                            rejouer()
                        }
                    }
                   vider()
                    //Affichage des points
                    coup.innerHTML="le joueur X = "+coupsX+" coups gagnants</br> le joueur O = "+coupsO+" coups gagnants"
                    
                    //si un des deux joueur gagne la partie, vider les tableaux et les cases 
                    function rejouer(){
                        
                            cases.forEach(elem=>{
                                elem.innerHTML=""
                            
                            })
                         
                    }
                     
                    reJouer.addEventListener('click',function(){
                        rejouer()
                    })
                   
                    restart.addEventListener('click',function(){
                        rejouer()
                        coupsO = 0
                        coupsX = 0
                        coup.innerHTML="le joueur X = "+coupsX+" coups gagnants</br> le joueur O = "+coupsO+" coups gagnants"
                    })
                    

            })

            
        })
        // problème, je ne peux réecrire de X ou O dans le tableau 


    </script>
</body>
</html>